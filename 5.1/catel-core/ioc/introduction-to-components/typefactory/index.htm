<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>TypeFactory - Catel documentation</title>
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../css/theme_colors.css" type="text/css" />
    <link rel="stylesheet" href="../../../../css/styles/vs.css">
    <link rel="stylesheet" href="../../../../css/font-awesome.4.5.0.min.css">
</head>
<body role="document">
    <div class="grid-for-nav">
        <nav data-toggle="nav-shift" class="nav-side stickynav">
            <div class="side-nav-search">
                <a href="/welcome/index.htm"><i class="fa fa-home"></i> Catel documentation</a>
                <div role="search">
                    <form id="search-form" class="form" action="../../../../Docnet_search.htm" method="get">
                        <input type="text" name="q" placeholder="Search docs" />
                    </form>
                </div>
            </div>
            <div class="menu menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
<ul>
<li class="tocentry"><a href="../../../../home.htm">Home</a>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../introduction/">Introduction</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../faq/">FAQ</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../setup-deployment/">Setup, deployment & projects</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../getting-started/">Getting started</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../examples/">Examples</a></span>
</li>
<li class="tocentry">
<ul>
<li><span class="navigationgroup"><i class="fa fa-caret-down"></i> <a href="../../../../catel-core/">Catel.Core</a></span></li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/apicop/">ApiCop</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/argument-checking/">Argument checking</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/caching/">Caching</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/configuration/">Configuration</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/data-handling/">Data handling</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/exception-handling/">Exception handling</a></span>
</li>
<li class="tocentry">
<ul>
<li><span class="navigationgroup"><i class="fa fa-caret-down"></i> <a href="../../../../catel-core/ioc/">IoC (ServiceLocator & TypeFactory)</a></span></li>
<li class="tocentry"><a href="../../../../catel-core/ioc/introduction/">Introduction</a>
</li>
<li class="tocentry"><a href="../../../../catel-core/ioc/dependency-injection/">Dependency injection</a>
</li>
<li class="tocentry">
<ul>
<li><span class="navigationgroup"><i class="fa fa-caret-down"></i> <a href="../../../../catel-core/ioc/introduction-to-components/">Introduction to IoC components</a></span></li>
<li class="tocentry"><a href="../../../../catel-core/ioc/introduction-to-components/servicelocator/">ServiceLocator</a>
</li>
<li class="tocentry current"><a class="current" href="../../../../catel-core/ioc/introduction-to-components/typefactory/">TypeFactory</a>
<ul class="currentrelative">
<li class="tocentry"><a href="#dependency-injection">Dependency injection</a></li>

<li class="tocentry"><a href="#introduction-to-dependency-injection">Introduction to dependency injection</a></li>

<li class="tocentry"><a href="#using-dependency-injection-in-catel">Using dependency injection in Catel</a></li>

<li class="tocentry"><a href="#disabling-dependency-injection">Disabling dependency injection</a></li>

<li class="tocentry"><a href="#custom-initialization">Custom initialization</a></li>



</ul>
<li class="tocentry"><a href="../../../../catel-core/ioc/introduction-to-components/dependencyresolver/">DependencyResolver & DependencyResolverManager</a>
</li>
<li class="tocentry"><a href="../../../../catel-core/ioc/introduction-to-components/ensuring-integrity/">Ensuring integrity of the ServiceLocator</a>
</li>

</ul>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/ioc/automatic-type-registration/">Automatic type registration</a></span>
</li>
<li class="tocentry"><a href="../../../../catel-core/ioc/setting-up-using-configuration/">Setting up the ServiceLocator using configuration</a>
</li>
<li class="tocentry"><a href="../../../../catel-core/ioc/replacing-default-components/">Replacing the default components</a>
</li>

</ul>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/logging/">Logging</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/messaging/">Messaging</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/multilingual/">Multilingual</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/parallel-invocation-tasks/">Parallel invocation & tasks</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/pooling/">Pooling</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/preventing-memory-leaks/">Preventing memory leaks</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/reflection/">Reflection</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/scoping/">Scoping</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/serialization/">Serialization</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-core/validation/">Validation</a></span>
</li>

</ul>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-mvvm/">Catel.MVVM</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-fody/">Catel.Fody</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../catel-resharper/">Catel.ReSharper</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../tips-tricks/">Tips & tricks</a></span>
</li>
<li class="tocentry">
<span class="navigationgroup"><i class="fa fa-caret-right"></i> <a href="../../../../reference/">API reference</a></span>
</li>

</ul>
				<div class="toc-footer">
					<span class="text-small">
						<hr/>
						<a href="https://github.com/FransBouma/DocNet" target="_blank">Made with <i class="fa fa-github"></i> DocNet</a>
					</span>
				</div>	
			</div>
            &nbsp;
        </nav>
        <section data-toggle="nav-shift" class="nav-content-wrap">
            <nav class="nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="nav-top" class="fa fa-bars"></i>
                <a href="../../../../index.htm">Catel documentation</a>
            </nav>
            <div class="nav-content">
                <div role="navigation" aria-label="breadcrumbs navigation">
                    <div class="breadcrumbs">
<ul><li><a href="../../../../home.htm">Home</a></li> / <li><a href="../../../../catel-core/index.htm">Catel.Core</a></li> / <li><a href="../../../../catel-core/ioc/index.htm">IoC (ServiceLocator & TypeFactory)</a></li> / <li><a href="../../../../catel-core/ioc/introduction-to-components/index.htm">Introduction to IoC components</a></li> / <li><a href="../../../../catel-core/ioc/introduction-to-components/typefactory/index.htm">TypeFactory</a></li></ul>

                    </div>
                    <hr />
                </div>
                <div role="main">
                    <div class="section">
<h1 id="introduction-to-the-typefactory">Introduction to the TypeFactory<a class="headerlink" href="#introduction-to-the-typefactory" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h1>
<p>The <em>TypeFactory</em> is responsible for actually creating types inside Catel. It uses the following mechanism:</p>
<ol>
<li>List all the constructors, order them from most parameters to least parameters</li>
<li>
While (constructors available)
    try to construct type using injection
</li>
<li>If all constructors fail, the <code>TypeFactory</code> will fallback to <code>Activator.CreateInstance()</code></li>
</ol>
<h2 id="dependency-injection">Dependency injection<a class="headerlink" href="#dependency-injection" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>The ServiceLocator in Catel supports dependency injection.</p>
<h2 id="introduction-to-dependency-injection">Introduction to dependency injection<a class="headerlink" href="#introduction-to-dependency-injection" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>Some people make dependency injection hard to understand, or maybe they don't understand it themselves. Dependency injection simply means that instead of hard referencing or instantiating other classes (dependendies), the dependencies are injected into the class via the constructor.</p>
<p><strong>Example 1: bad, instantiates the dependencies itself</strong></p>
<pre class="nocode">public class MyClass
{
    private IFirstDependency _firstDependency;
    private ISecondDependency _secondDependency;

    public MyClass()
    {
        _firstDependency = new FirstDependency();
        _secondDependency = new SecondDependency();
    }
}
</pre><p><strong>Example 2: good, retrieves the dependencies via the service locator</strong>)</p>
<pre class="nocode">public class MyClass
{
    private IFirstDependency _firstDependency;
    private ISecondDependency _secondDependency;

    public MyClass()
    {
        _firstDependency = ServiceLocator.Instance.ResolveType&lt;IFirstDependency&gt;();
        _secondDependency = ServiceLocator.Instance.ResolveType&lt;ISecondDependency&gt;();
    }
}
</pre><p> </p>
<p><strong>Example 3: good, gets the dependencies injected</strong></p>
<pre class="nocode">public class MyClass
{
    private IFirstDependency _firstDependency;
    private ISecondDependency _secondDependency;

    public MyClass(IFirstDependency firstDependency, ISecondDependency secondDepdenceny)
    {
        Argument.IsNotNull(&quot;firstDependency&quot;, firstDependency);
        Argument.IsNotNull(&quot;secondDependency&quot;, secondDependency);

        _firstDependency = firstDependency;
        _secondDependency = secondDependency;
    }
}
</pre><div class="alert alert-info"><span class="alert-title"><i class="fa fa-info-circle"></i> Info</span><p>There are other ways of using dependency injection, for example via attributes. This documentation will focus on dependency injection via the constructor only</p>
</div><h2 id="using-dependency-injection-in-catel">Using dependency injection in Catel<a class="headerlink" href="#using-dependency-injection-in-catel" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>Dependency injection via the ServiceLocator in Catel is enabled by default. This means that when a type is resolved from the container, it will automatically use dependency injection to construct the type if it is not registered as instance.</p>
<p>It will first search for all available constructors on the type that will be instantiated. Then, for each constructor, starting with the one with the most parameters, it will try to retrieve all values. If one fails, it will go to the next. If all fail, it will try to use the default constructor without parameters. If that fails as well, then the type cannot be constructed and an exception will be thrown.</p>
<p>To get a better understanding of what happens, see the class below:</p>
<pre class="nocode">public class MyClass
{
    private IFirstDependency _firstDependency;
    private ISecondDependency _secondDependency;

    public MyClass()
        : this(null) { }

    public MyClass(IFirstDependency firstDependency)
        : this(firstDependency, null) { }

    public MyClass(IFirstDependency firstDependency, ISecondDependency secondDepdenceny)
    {
        _firstDependency = firstDependency;
        _secondDependency = secondDependency;
    }
}
</pre><p>When the MyClass will be retrieved from the ServiceLocator, this will happen:</p>
<ol>
<li>Find constructor with most parameters (the one with both firstDependency and secondDependency). If both IFirstDependency and ISecondDependency can be resolved from the ServiceLocator, the type will be constructed with the constructor. Otherwise it will proceed with step 2.</li>
<li>Find next constructor with most parameters (the one with only firstDependency). If IFirstDependency can be resolved from the ServiceLocator, the type will be constructed with the constructor. Otherwise it will proceed with step 3.</li>
<li>At this point, no constructor could be used. In this case, the ServiceLocator will try to use the default constructor (the one without parameters) as last resort to instantiate the type.</li>
</ol>
<h2 id="disabling-dependency-injection">Disabling dependency injection<a class="headerlink" href="#disabling-dependency-injection" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p> Maybe you don't want dependency injection because it does not give you what you need or you want a very, very small improvement in performance. In that case, the dependency injection can be disabled using the code below:</p>
<pre class="nocode">ServiceLocator.Default.SupportedDependencyInjection = false
</pre><h2 id="custom-initialization">Custom initialization<a class="headerlink" href="#custom-initialization" title="Permalink to this headline"><i class="fa fa-link" aria-hidden="true"></i></a></h2>
<p>All types created with the <code>TypeFactory</code> can be initialized with custom code. This can be done by implementing the <code>INeedCustomInitialization</code> interface. As soon as a type is created, the TypeFactory will check whether it implements the INeedCustomInitialization interface. If so, it will call the Initialize method of the interface.</p>
<div class="alert alert-warning"><span class="alert-title"><i class="fa fa-warning"></i> Important!</span><p>To prevent misuse of the <code>Initialize</code> method, it is best to implement the interface explicitly</p>
</div>
                    </div>
                </div>
                <footer>
                    <hr />
                    <div role="contentinfo">

                      <p>
					    Is this section not up-to-date or found an issue? Please <a href="https://github.com/Catel/Catel.Docs/blob/master/src/vnext/catel-core/ioc/introduction-to-components/typefactory.md" target="_blank">contribute</a>!
					  </p>
					  <p>
					    Have a question about Catel? Use <a href="https://stackoverflow.com/questions/tagged/catel" target="_blank">StackOverflow</a> with the <i>Catel</i> tag!
					  </p>
					  <hr />
					  <p>
					    <h2>Discussion</h2>
					   <div id="disqus_thread"></div>
					   <script>
					   var disqus_config = function () {
					   // Always use vNext so comments stay visible
					   this.page.url = 'http://docs.catelproject.com/vnext/catel-core/ioc/introduction-to-components/typefactory/index.htm';
					   this.page.identifier = 'catel-core/ioc/introduction-to-components/typefactory.md';
					   };
					   (function() { // DON'T EDIT BELOW THIS LINE
					   var d = document, s = d.createElement('script');
					   s.src = 'https://catel-docs.disqus.com/embed.js';
					   s.setAttribute('data-timestamp', +new Date());
					   (d.head || d.body).appendChild(s);
					   })();
					   </script>
					   <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
					  </p>
					</div>
                </footer>
            </div>
        </section>
    </div>
    <script src="../../../../js/jquery-2.1.1.min.js"></script>
    <script src="../../../../js/modernizr-2.8.3.min.js"></script>
    <script src="../../../../js/highlight.pack.js"></script>
    <script src="../../../../js/theme.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-25600919-4', 'auto');
      ga('send', 'pageview');
    
    </script>
</body>
</html>
